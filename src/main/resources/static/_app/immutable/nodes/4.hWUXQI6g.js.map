{"version":3,"file":"4.hWUXQI6g.js","sources":["../../../../../../src/routes/mealplan/+page.svelte"],"sourcesContent":["<script>\r\n  import axios from \"axios\";\r\n  import { onMount } from \"svelte\";\r\n  import { jwt_token } from \"../../store\";\r\n  import { page } from \"$app/stores\";\r\n\r\n  const api_root = `${$page.url.origin}/api`;\r\n\r\n\r\n  let mealPlans = [];\r\n  let selectedMealPlan = null; // Für die Auswahl eines spezifischen MealPlans\r\n  let recipesForSelectedMealPlan = []; // Rezeptdetails für den ausgewählten MealPlan\r\n  let isLoading = false;\r\n  let errorMessage = \"\";\r\n\r\n  // JWT-Token debuggen (nur zu Debugging-Zwecken hinzufügen)\r\n  console.log(\"JWT Token:\", $jwt_token);\r\n\r\n  // Token dekodieren (optional, falls Debugging erforderlich ist)\r\n  // import jwt_decode from \"jwt-decode\";\r\n  // const decodedToken = jwt_decode($jwt_token);\r\n  // console.log(\"Decoded Token:\", decodedToken);\r\n\r\n  // MealPlans beim Laden der Seite abrufen\r\n  onMount(() => {\r\n    fetchMealPlans();\r\n  });\r\n\r\n  // MealPlans abrufen\r\n  async function fetchMealPlans() {\r\n    isLoading = true;\r\n    errorMessage = \"\";\r\n    try {\r\n      const response = await axios.get(`${api_root}/mealplan`, {\r\n        headers: { Authorization: \"Bearer \" + $jwt_token },\r\n      });\r\n      mealPlans = response.data;\r\n    } catch (error) {\r\n      if (error.response) {\r\n        if (error.response.status === 401) {\r\n          errorMessage = \"Unauthorized. Please check your login.\";\r\n        } else if (error.response.status === 403) {\r\n          errorMessage = \"Forbidden. You do not have access.\";\r\n        } else {\r\n          errorMessage = \"Error fetching meal plans: \" + error.response.data;\r\n        }\r\n      } else {\r\n        errorMessage = \"Network error or server not reachable.\";\r\n      }\r\n      console.error(\"Error fetching meal plans:\", error);\r\n    } finally {\r\n      isLoading = false;\r\n    }\r\n  }\r\n\r\n  // Rezepte für einen ausgewählten MealPlan abrufen\r\n  async function fetchRecipesForMealPlan(mealPlanId) {\r\n    isLoading = true;\r\n    errorMessage = \"\";\r\n    recipesForSelectedMealPlan = [];\r\n    try {\r\n      const response = await axios.get(`${api_root}/mealplan/${mealPlanId}/recipes`, {\r\n        headers: { Authorization: \"Bearer \" + $jwt_token },\r\n      });\r\n      recipesForSelectedMealPlan = response.data;\r\n      selectedMealPlan = mealPlans.find((plan) => plan.id === mealPlanId);\r\n    } catch (error) {\r\n      if (error.response) {\r\n        if (error.response.status === 401) {\r\n          errorMessage = \"Unauthorized. Please check your login.\";\r\n        } else if (error.response.status === 403) {\r\n          errorMessage = \"Forbidden. You do not have access.\";\r\n        } else {\r\n          errorMessage = \"Error fetching recipes: \" + error.response.data;\r\n        }\r\n      } else {\r\n        errorMessage = \"Network error or server not reachable.\";\r\n      }\r\n      console.error(\"Error fetching recipes for meal plan:\", error);\r\n    } finally {\r\n      isLoading = false;\r\n    }\r\n  }\r\n  \r\n</script>\r\n\r\n<h1 class=\"mt-3\">Meal Plans</h1>\r\n\r\n{#if isLoading}\r\n  <div class=\"spinner-border text-primary\" role=\"status\">\r\n    <span class=\"visually-hidden\">Loading...</span>\r\n  </div>\r\n{:else if errorMessage}\r\n  <div class=\"alert alert-danger\">{errorMessage}</div>\r\n{:else}\r\n  <table class=\"table\">\r\n    <thead>\r\n      <tr>\r\n        <th scope=\"col\">Meal Plan Name</th>\r\n        <th scope=\"col\">Description</th>\r\n        <th scope=\"col\">Actions</th>\r\n      </tr>\r\n    </thead>\r\n    <tbody>\r\n      {#each mealPlans as mealPlan}\r\n        <tr>\r\n          <td>{mealPlan.name}</td>\r\n          <td>{mealPlan.description}</td>\r\n          <td>\r\n            <button\r\n              class=\"btn btn-primary btn-sm\"\r\n              on:click={() => fetchRecipesForMealPlan(mealPlan.id)}\r\n            >\r\n              View Recipes\r\n            </button>\r\n          </td>\r\n        </tr>\r\n      {/each}\r\n    </tbody>\r\n  </table>\r\n{/if}\r\n\r\n{#if selectedMealPlan}\r\n  <h2 class=\"mt-4\">Recipes for \"{selectedMealPlan.name}\"</h2>\r\n  <p>{selectedMealPlan.description}</p>\r\n\r\n  {#if recipesForSelectedMealPlan.length > 0}\r\n    <table class=\"table\">\r\n      <thead>\r\n        <tr>\r\n          <th scope=\"col\">Recipe Name</th>\r\n          <th scope=\"col\">Ingredients</th>\r\n          <th scope=\"col\">Calories</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        {#each recipesForSelectedMealPlan as recipe}\r\n          <tr>\r\n            <td>{recipe.name}</td>\r\n            <td>{recipe.ingredients.join(\", \")}</td>\r\n            <td>{recipe.calories}</td>\r\n          </tr>\r\n        {/each}\r\n      </tbody>\r\n    </table>\r\n  {:else}\r\n    <p>No recipes found for this meal plan.</p>\r\n  {/if}\r\n{/if}\r\n"],"names":["ctx","i","insert_hydration","target","table","anchor","append_hydration","thead","tbody","div","t0_value","t2_value","tr","td0","td1","td2","button","dirty","set_data","t0","t2","t1_value","t4_value","create_if_block_1","h2","p","t1","t4","create_if_block_2","create_if_block_3","create_if_block","h1","api_root","$page","mealPlans","selectedMealPlan","recipesForSelectedMealPlan","isLoading","errorMessage","$jwt_token","onMount","fetchMealPlans","$$invalidate","response","axios","error","fetchRecipesForMealPlan","mealPlanId","plan","mealPlan"],"mappings":"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"}