{"version":3,"file":"5.DM_dROBp.js","sources":["../../../../../../src/routes/recipe/+page.svelte"],"sourcesContent":["<script>\r\n  import axios from \"axios\";\r\n  import { jwt_token } from \"../../store\"; \r\n  import { onMount } from \"svelte\";\r\n  import { page } from \"$app/stores\";\r\n\r\n  const api_root = `${$page.url.origin}/api`;\r\n\r\n  let recipes = [];\r\n  let recipe = {\r\n    name: null,\r\n    ingredients: null,\r\n    calories: null,\r\n  };\r\n\r\n  let mealPlans = [];\r\n  let selectedMealPlanId = null;\r\n  let selectedRecipeForMealPlan = null;\r\n\r\n  let editRecipeId = null; // ID des zu bearbeitenden Rezepts\r\n\r\n  // Fetch all recipes on mount\r\n  onMount(() => {\r\n    getRecipes();\r\n    fetchMealPlans(); // Fetch MealPlans on page load\r\n  });\r\n\r\n  // Get all recipes\r\n  function getRecipes() {\r\n    var config = {\r\n      method: \"get\",\r\n      url: api_root + \"/recipe\",\r\n      headers: { Authorization: \"Bearer \" + $jwt_token },\r\n    };\r\n\r\n    axios(config)\r\n      .then(function (response) {\r\n        recipes = response.data;\r\n      })\r\n      .catch(function (error) {\r\n        alert(\"Could not fetch recipes\");\r\n        console.log(error);\r\n      });\r\n  }\r\n\r\n  function fetchMealPlans() {\r\n    axios.get(`${api_root}/mealplan`, {\r\n      headers: { Authorization: \"Bearer \" + $jwt_token },\r\n    })\r\n      .then((response) => {\r\n        mealPlans = response.data;\r\n      })\r\n      .catch((error) => {\r\n        console.error(\"Could not fetch meal plans:\", error);\r\n      });\r\n  }\r\n\r\n  function createRecipe() {\r\n    const formattedIngredients = recipe.ingredients\r\n      ? recipe.ingredients.split(\",\").map(item => item.trim())\r\n      : [];\r\n\r\n    const newRecipe = {\r\n      name: recipe.name || \"\",\r\n      ingredients: formattedIngredients,\r\n      calories: parseInt(recipe.calories, 10) || 0,\r\n    };\r\n\r\n    axios.post(api_root + \"/recipe\", newRecipe, {\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        Authorization: \"Bearer \" + $jwt_token,\r\n      },\r\n    })\r\n      .then(function () {\r\n        alert(\"Recipe created successfully\");\r\n        recipe = { name: \"\", ingredients: \"\", calories: \"\" };\r\n        getRecipes();\r\n      })\r\n      .catch(function (error) {\r\n        alert(\"Could not create recipe\");\r\n        console.error(\"Error:\", error);\r\n      });\r\n  }\r\n\r\n  function deleteRecipe(id) {\r\n    axios.delete(`${api_root}/recipe/${id}`, {\r\n      headers: {\r\n        Authorization: \"Bearer \" + $jwt_token,\r\n      },\r\n    })\r\n      .then(() => {\r\n        alert(\"Recipe deleted successfully\");\r\n        getRecipes();\r\n      })\r\n      .catch(error => {\r\n        alert(\"Could not delete recipe\");\r\n        console.error(\"Error:\", error);\r\n      });\r\n  }\r\n\r\n  function editRecipe(recipeToEdit) {\r\n    editRecipeId = recipeToEdit.id;\r\n    recipe = {\r\n      name: recipeToEdit.name,\r\n      ingredients: recipeToEdit.ingredients.join(\", \"),\r\n      calories: recipeToEdit.calories,\r\n    };\r\n  }\r\n\r\n  function updateRecipe() {\r\n    const formattedIngredients = recipe.ingredients\r\n      ? recipe.ingredients.split(\",\").map(item => item.trim())\r\n      : [];\r\n\r\n    const updatedRecipe = {\r\n      name: recipe.name || \"\",\r\n      ingredients: formattedIngredients,\r\n      calories: parseInt(recipe.calories, 10) || 0,\r\n    };\r\n\r\n    axios.put(`${api_root}/recipe/${editRecipeId}`, updatedRecipe, {\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        Authorization: \"Bearer \" + $jwt_token,\r\n      },\r\n    })\r\n      .then(() => {\r\n        alert(\"Recipe updated successfully\");\r\n        recipe = { name: \"\", ingredients: \"\", calories: \"\" };\r\n        editRecipeId = null;\r\n        getRecipes();\r\n      })\r\n      .catch(error => {\r\n        alert(\"Could not update recipe\");\r\n        console.error(\"Error:\", error);\r\n      });\r\n  }\r\n\r\n  function openMealPlanSelector(recipeId) {\r\n    selectedRecipeForMealPlan = recipes.find((r) => r.id === recipeId);\r\n    selectedMealPlanId = null;\r\n  }\r\n\r\n  function assignRecipeToMealPlan() {\r\n    if (!selectedMealPlanId || !selectedRecipeForMealPlan) {\r\n      alert(\"Please select a Meal Plan.\");\r\n      return;\r\n    }\r\n\r\n    axios.put(\r\n  `${api_root}/mealplan/${selectedMealPlanId}/recipes`,\r\n  { recipeId: selectedRecipeForMealPlan.id }, // recipeId als String\r\n  {\r\n    headers: {\r\n      Authorization: \"Bearer \" + $jwt_token,\r\n    },\r\n  }\r\n)\r\n  .then(() => {\r\n    alert(\"Recipe added to Meal Plan successfully.\");\r\n    selectedRecipeForMealPlan = null;\r\n    selectedMealPlanId = null;\r\n  })\r\n  .catch((error) => {\r\n    console.error(\"Error assigning recipe to Meal Plan:\", error);\r\n    alert(\"Could not add the recipe to the Meal Plan.\");\r\n  });\r\n}\r\n</script>\r\n\r\n<h1 class=\"mt-3\">{editRecipeId ? \"Edit Recipe\" : \"Create Recipe\"}</h1>\r\n<form class=\"mb-5\">\r\n  <div class=\"row mb-3\">\r\n    <div class=\"col\">\r\n      <label class=\"form-label\" for=\"name\">Name</label>\r\n      <input\r\n        bind:value={recipe.name}\r\n        class=\"form-control\"\r\n        id=\"name\"\r\n        type=\"text\"\r\n      />\r\n    </div>\r\n    <div class=\"col\">\r\n      <label class=\"form-label\" for=\"ingredients\">Ingredients (comma-separated)</label>\r\n      <input\r\n        bind:value={recipe.ingredients}\r\n        class=\"form-control\"\r\n        id=\"ingredients\"\r\n        type=\"text\"\r\n      />\r\n    </div>\r\n  </div>\r\n  <div class=\"row mb-3\">\r\n    <div class=\"col\">\r\n      <label class=\"form-label\" for=\"calories\">Calories</label>\r\n      <input\r\n        bind:value={recipe.calories}\r\n        class=\"form-control\"\r\n        id=\"calories\"\r\n        type=\"number\"\r\n      />\r\n    </div>  \r\n  </div>\r\n\r\n  <button type=\"button\" class=\"btn btn-primary\" on:click={editRecipeId ? updateRecipe : createRecipe}>\r\n    {editRecipeId ? \"Update\" : \"Submit\"}\r\n  </button>\r\n</form>\r\n\r\n<h1>All Recipes</h1>\r\n<table class=\"table\">\r\n  <thead>\r\n    <tr>\r\n      <th scope=\"col\">Name</th>\r\n      <th scope=\"col\">Ingredients</th>\r\n      <th scope=\"col\">Calories</th>\r\n      <th scope=\"col\">Actions</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    {#each recipes as recipe}\r\n      <tr>\r\n        <td>{recipe.name}</td>\r\n        <td>{recipe.ingredients ? recipe.ingredients.join(\", \") : \"\"}</td>\r\n        <td>{recipe.calories}</td>\r\n        <td>\r\n          <button class=\"btn btn-secondary btn-sm\" on:click={() => editRecipe(recipe)}>Edit</button>\r\n          <button class=\"btn btn-danger btn-sm\" on:click={() => deleteRecipe(recipe.id)}>Delete</button>\r\n          <button class=\"btn btn-success btn-sm\" on:click={() => openMealPlanSelector(recipe.id)}>Add to Meal Plan</button>\r\n        </td>\r\n      </tr>\r\n    {/each}\r\n  </tbody>\r\n</table>\r\n\r\n{#if selectedRecipeForMealPlan}\r\n  <div class=\"modal show\" tabindex=\"-1\" style=\"display: block;\" role=\"dialog\">\r\n    <div class=\"modal-dialog\" role=\"document\">\r\n      <div class=\"modal-content\">\r\n        <div class=\"modal-header\">\r\n          <h5 class=\"modal-title\">Add \"{selectedRecipeForMealPlan.name}\" to a Meal Plan</h5>\r\n          <button type=\"button\" class=\"btn-close\" on:click={() => selectedRecipeForMealPlan = null}></button>\r\n        </div>\r\n        <div class=\"modal-body\">\r\n          <label for=\"mealplan-select\">Select a Meal Plan:</label>\r\n          <select bind:value={selectedMealPlanId} id=\"mealplan-select\" class=\"form-select\">\r\n            <option value=\"\" disabled>Select Meal Plan</option>\r\n            {#each mealPlans as mealPlan}\r\n              <option value={mealPlan.id}>{mealPlan.name}</option>\r\n            {/each}\r\n          </select>\r\n        </div>\r\n        <div class=\"modal-footer\">\r\n          <button\r\n            type=\"button\"\r\n            class=\"btn btn-primary\"\r\n            on:click={assignRecipeToMealPlan}\r\n          >\r\n            Add\r\n          </button>\r\n          <button\r\n            type=\"button\"\r\n            class=\"btn btn-secondary\"\r\n            on:click={() => selectedRecipeForMealPlan = null}\r\n          >\r\n            Cancel\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n{/if}\r\n"],"names":["t0_value","ctx","t2_value","t4_value","insert_hydration","target","tr","anchor","append_hydration","td0","td1","td2","td3","button0","button1","button2","dirty","set_data","t0","t2","t4","t1_value","i","add_render_callback","select","div5","div4","div3","div0","h5","div1","label","option","div2","t1","t_value","option_value_value","t","create_if_block","h10","form","label0","input0","set_input_value","label1","input1","label2","input2","button","h11","table","thead","tbody","to_number","t11","t11_value","api_root","$page","recipes","recipe","mealPlans","selectedMealPlanId","selectedRecipeForMealPlan","editRecipeId","onMount","getRecipes","fetchMealPlans","config","$jwt_token","axios","response","error","createRecipe","formattedIngredients","item","newRecipe","deleteRecipe","id","editRecipe","recipeToEdit","updateRecipe","updatedRecipe","$$invalidate","openMealPlanSelector","recipeId","r","assignRecipeToMealPlan","click_handler","click_handler_3","select_value"],"mappings":"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"}