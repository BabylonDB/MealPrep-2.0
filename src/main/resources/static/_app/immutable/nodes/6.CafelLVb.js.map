{"version":3,"file":"6.CafelLVb.js","sources":["../../../../../../src/routes/shoppinglist/+page.svelte"],"sourcesContent":["<script>\r\n    import axios from \"axios\";\r\n    import { onMount } from \"svelte\";\r\n    import { jwt_token } from \"../../store\"; \r\n\r\n    const api_root = \"http://localhost:8080/api\";\r\n\r\n    let recipes = [];\r\n    let selectedRecipeId = null;\r\n    let ingredients = [];\r\n    let isLoading = false;\r\n    let errorMessage = \"\";\r\n    let mealPlans = [];\r\n    let selectedMealPlanId = null;\r\n    let shoppingList = [];\r\n    let recipesForSelectedMealPlan = [];\r\n\r\n    // Fetch all recipes\r\n    async function getRecipes() {\r\n        isLoading = true;\r\n        errorMessage = \"\";\r\n        try {\r\n            const response = await axios.get(`${api_root}/recipe`, {\r\n                headers: { Authorization: \"Bearer \" + $jwt_token },\r\n            });\r\n            recipes = response.data;\r\n            console.log('Fetched recipes:', recipes);\r\n        } catch (error) {\r\n            errorMessage = \"Could not fetch recipes.\";\r\n            console.error(error);\r\n        } finally {\r\n            isLoading = false;\r\n        }\r\n    }\r\n\r\n    // Fetch all meal plans\r\n    async function getMealPlans() {\r\n        isLoading = true;\r\n        errorMessage = \"\";\r\n        try {\r\n            const response = await axios.get(`${api_root}/mealplan`, {\r\n                headers: { Authorization: \"Bearer \" + $jwt_token },\r\n            });\r\n            mealPlans = response.data;\r\n            console.log('Fetched meal plans:', mealPlans);\r\n            console.log('Selected Meal Plan ID:', selectedMealPlanId);\r\n        } catch (error) {\r\n            errorMessage = \"Could not fetch meal plans.\";\r\n            console.error(error);\r\n        } finally {\r\n            isLoading = false;\r\n        }\r\n    }\r\n\r\n    // Fetch recipes for a selected meal plan\r\n    async function fetchRecipesForMealPlan(mealPlanId) {\r\n        console.log('hELLOR');\r\n        isLoading = true;\r\n        errorMessage = \"\";\r\n        recipesForSelectedMealPlan = [];\r\n        try {\r\n            const response = await axios.get(`${api_root}/mealplan/${mealPlanId}/recipes`, {\r\n                headers: { Authorization: \"Bearer \" + $jwt_token },\r\n            });\r\n            recipesForSelectedMealPlan = response.data;\r\n            console.log('Fetched recipes for selected meal plan:', recipesForSelectedMealPlan);\r\n            ingredients = recipesForSelectedMealPlan.flatMap(recipe => recipe.ingredients);\r\n        } catch (error) {\r\n            if (error.response) {\r\n                if (error.response.status === 401) {\r\n                    errorMessage = \"Unauthorized. Please check your login.\";\r\n                } else if (error.response.status === 403) {\r\n                    errorMessage = \"Forbidden. You do not have access.\";\r\n                } else {\r\n                    errorMessage = \"Error fetching recipes: \" + error.response.data;\r\n                }\r\n            } else {\r\n                errorMessage = \"Network error or server not reachable.\";\r\n            }\r\n            console.error(\"Error fetching recipes for meal plan:\", error);\r\n        } finally {\r\n            isLoading = false;\r\n        }\r\n    }\r\n\r\n    // Fetch recipes and meal plans on component mount\r\n    onMount(() => {\r\n        getRecipes();\r\n        getMealPlans();\r\n    });\r\n</script>\r\n\r\n<h1>Shopping List Manager</h1>\r\n\r\n{#if isLoading}\r\n    <div class=\"spinner-border text-primary\" role=\"status\">\r\n        <span class=\"visually-hidden\">Loading...</span>\r\n    </div>\r\n{:else}\r\n    {#if errorMessage}\r\n        <div class=\"alert alert-danger\">{errorMessage}</div>\r\n    {/if}\r\n\r\n    <div class=\"mb-4\">\r\n        <label for=\"mealPlanSelector\" class=\"form-label\">Select a Meal Plan</label>\r\n        <select\r\n             id=\"mealPlanSelector\"\r\n             class=\"form-select\"\r\n             bind:value={selectedMealPlanId}\r\n               on:change={() => {\r\n                console.log('Dropdown changed, selectedMealPlanId:', selectedMealPlanId);\r\n                if (selectedMealPlanId) {\r\n                   fetchRecipesForMealPlan(selectedMealPlanId);\r\n                }\r\n             }}\r\n        >    \r\n            <option value=\"\" disabled selected={selectedMealPlanId === null}>Choose a Meal Plan</option>\r\n            {#each mealPlans as mealPlan}\r\n                <option value={mealPlan.id}>{mealPlan.name}</option>\r\n            {/each}\r\n        \r\n        </select>\r\n\r\n        \r\n        \r\n    </div>\r\n\r\n    {#if ingredients.length > 0}\r\n        <h2>Ingredients</h2>\r\n        <ul class=\"list-group\">\r\n            {#each ingredients as ingredient}\r\n                <li class=\"list-group-item\">{ingredient}</li>\r\n            {/each}\r\n        </ul>\r\n    {:else}\r\n        <p>No ingredients found for the selected Meal Plan.</p>\r\n    {/if}\r\n{/if}\r\n"],"names":["ctx","create_if_block_2","i","create_if_block_1","option","option_selected_value","add_render_callback","select","insert_hydration","target","div","anchor","append_hydration","label","dirty","t_value","option_value_value","set_data","t","p","h2","ul","li","create_if_block","h1","api_root","recipes","ingredients","isLoading","errorMessage","mealPlans","selectedMealPlanId","recipesForSelectedMealPlan","getRecipes","$$invalidate","axios","$jwt_token","error","getMealPlans","response","fetchRecipesForMealPlan","mealPlanId","recipe","onMount","select_value"],"mappings":"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"}