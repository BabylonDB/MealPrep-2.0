{"version":3,"file":"5.DXP1GxvV.js","sources":["../../../../../../src/routes/recipe/+page.svelte"],"sourcesContent":["<script>\n  import axios from \"axios\";\n  import { jwt_token } from \"../../store\"; \n  import { onMount } from \"svelte\";\n  import { page } from \"$app/stores\";\n\n  const api_root = `${$page.url.origin}/api`;\n\n  let recipes = [];\n  let recipe = {\n    name: null,\n    ingredients: null,\n    calories: null,\n  };\n\n  let editRecipeId = null; // ID des zu bearbeitenden Rezepts\n\n  // Fetch all recipes on mount\n  onMount(() => {\n    getRecipes();\n  });\n\n  // Get all recipes\n  function getRecipes() {\n    var config = {\n      method: \"get\",\n      url: api_root + \"/recipe\",\n      headers: { Authorization: \"Bearer \" + $jwt_token },\n    };\n\n    axios(config)\n      .then(function (response) {\n        recipes = response.data;\n      })\n      .catch(function (error) {\n        alert(\"Could not fetch recipes\");\n        console.log(error);\n      });\n  }\n\n  function createRecipe() {\n    const formattedIngredients = recipe.ingredients\n      ? recipe.ingredients.split(\",\").map(item => item.trim())\n      : [];\n\n    const newRecipe = {\n      name: recipe.name || \"\",\n      ingredients: formattedIngredients,\n      calories: parseInt(recipe.calories, 10) || 0,\n    };\n\n    axios.post(api_root + \"/recipe\", newRecipe, {\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + $jwt_token,\n      },\n    })\n      .then(function () {\n        alert(\"Recipe created successfully\");\n        recipe = { name: \"\", ingredients: \"\", calories: \"\" };\n        getRecipes();\n      })\n      .catch(function (error) {\n        alert(\"Could not create recipe\");\n        console.error(\"Error:\", error);\n      });\n  }\n\n  function deleteRecipe(id) {\n    axios.delete(`${api_root}/recipe/${id}`, {\n      headers: {\n        Authorization: \"Bearer \" + $jwt_token,\n      },\n    })\n      .then(() => {\n        alert(\"Recipe deleted successfully\");\n        getRecipes();\n      })\n      .catch(error => {\n        alert(\"Could not delete recipe\");\n        console.error(\"Error:\", error);\n      });\n  }\n\n  function editRecipe(recipeToEdit) {\n    editRecipeId = recipeToEdit.id;\n    recipe = {\n      name: recipeToEdit.name,\n      ingredients: recipeToEdit.ingredients.join(\", \"),\n      calories: recipeToEdit.calories,\n    };\n  }\n\n  function updateRecipe() {\n    const formattedIngredients = recipe.ingredients\n      ? recipe.ingredients.split(\",\").map(item => item.trim())\n      : [];\n\n    const updatedRecipe = {\n      name: recipe.name || \"\",\n      ingredients: formattedIngredients,\n      calories: parseInt(recipe.calories, 10) || 0,\n    };\n\n    axios.put(`${api_root}/recipe/${editRecipeId}`, updatedRecipe, {\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + $jwt_token,\n      },\n    })\n      .then(() => {\n        alert(\"Recipe updated successfully\");\n        recipe = { name: \"\", ingredients: \"\", calories: \"\" };\n        editRecipeId = null;\n        getRecipes();\n      })\n      .catch(error => {\n        alert(\"Could not update recipe\");\n        console.error(\"Error:\", error);\n      });\n  }\n</script>\n\n<h1 class=\"mt-3\">{editRecipeId ? \"Edit Recipe\" : \"Create Recipe\"}</h1>\n<form class=\"mb-5\">\n  <div class=\"row mb-3\">\n    <div class=\"col\">\n      <label class=\"form-label\" for=\"name\">Name</label>\n      <input\n        bind:value={recipe.name}\n        class=\"form-control\"\n        id=\"name\"\n        type=\"text\"\n      />\n    </div>\n    <div class=\"col\">\n      <label class=\"form-label\" for=\"ingredients\">Ingredients (comma-separated)</label>\n      <input\n        bind:value={recipe.ingredients}\n        class=\"form-control\"\n        id=\"ingredients\"\n        type=\"text\"\n      />\n    </div>\n  </div>\n  <div class=\"row mb-3\">\n    <div class=\"col\">\n      <label class=\"form-label\" for=\"calories\">Calories</label>\n      <input\n        bind:value={recipe.calories}\n        class=\"form-control\"\n        id=\"calories\"\n        type=\"number\"\n      />\n    </div>  \n  </div>\n\n  <button type=\"button\" class=\"btn btn-primary\" on:click={editRecipeId ? updateRecipe : createRecipe}>\n    {editRecipeId ? \"Update\" : \"Submit\"}\n  </button>\n</form>\n\n<h1>All Recipes</h1>\n<table class=\"table\">\n  <thead>\n    <tr>\n      <th scope=\"col\">Name</th>\n      <th scope=\"col\">Ingredients</th>\n      <th scope=\"col\">Calories</th>\n      <th scope=\"col\">Actions</th>\n    </tr>\n  </thead>\n  <tbody>\n    {#each recipes as recipe}\n      <tr>\n        <td>{recipe.name}</td>\n        <td>{recipe.ingredients ? recipe.ingredients.join(\", \") : \"\"}</td>\n        <td>{recipe.calories}</td>\n        <td>\n          <button class=\"btn btn-secondary btn-sm\" on:click={() => editRecipe(recipe)}>Edit</button>\n          <button class=\"btn btn-danger btn-sm\" on:click={() => deleteRecipe(recipe.id)}>Delete</button>\n        </td>\n      </tr>\n    {/each}\n  </tbody>\n</table>\n"],"names":["t0_value","ctx","t2_value","t4_value","insert_hydration","target","tr","anchor","append_hydration","td0","td1","td2","td3","button0","button1","dirty","set_data","t0","t2","t4","i","h10","form","div2","div0","label0","input0","set_input_value","div1","label1","input1","div4","div3","label2","input2","button","h11","table","thead","tbody","to_number","t11","t11_value","api_root","$page","recipes","recipe","editRecipeId","onMount","getRecipes","config","$jwt_token","axios","response","error","createRecipe","formattedIngredients","item","newRecipe","deleteRecipe","id","editRecipe","recipeToEdit","updateRecipe","updatedRecipe","$$invalidate"],"mappings":"8hBA+KaA,EAAAC,KAAO,KAAI,SACXC,GAAAD,KAAO,YAAcA,EAAO,CAAA,EAAA,YAAY,KAAK,IAAI,EAAI,IAAE,SACvDE,EAAAF,KAAO,SAAQ,wzBAHtBG,EAQIC,EAAAC,EAAAC,CAAA,EAPFC,EAAqBF,EAAAG,CAAA,gBACrBD,EAAiEF,EAAAI,CAAA,gBACjEF,EAAyBF,EAAAK,CAAA,gBACzBH,EAGIF,EAAAM,CAAA,EAFFJ,EAAyFI,EAAAC,CAAA,SACzFL,EAA6FI,EAAAE,CAAA,iEAL1FC,EAAA,GAAAf,KAAAA,EAAAC,KAAO,KAAI,KAAAe,GAAAC,EAAAjB,CAAA,EACXe,EAAA,GAAAb,KAAAA,GAAAD,KAAO,YAAcA,EAAO,CAAA,EAAA,YAAY,KAAK,IAAI,EAAI,IAAE,KAAAe,GAAAE,EAAAhB,CAAA,EACvDa,EAAA,GAAAZ,KAAAA,EAAAF,KAAO,SAAQ,KAAAe,GAAAG,EAAAhB,CAAA,oDAtDVF,EAAY,CAAA,EAAG,cAAgB,oHAmC5CA,EAAY,CAAA,EAAG,SAAW,2LAepBA,EAAO,CAAA,CAAA,uBAAZ,OAAImB,GAAA,6sEAlDVhB,EAAqEC,EAAAgB,EAAAd,CAAA,kBACrEH,EAoCMC,EAAAiB,EAAAf,CAAA,EAnCJC,EAmBKc,EAAAC,CAAA,EAlBHf,EAQKe,EAAAC,CAAA,EAPHhB,EAAgDgB,EAAAC,CAAA,SAChDjB,EAKCgB,EAAAE,CAAA,EAJaC,EAAAD,EAAAzB,KAAO,IAAI,SAM3BO,EAQKe,EAAAK,CAAA,EAPHpB,EAAgFoB,EAAAC,CAAA,SAChFrB,EAKCoB,EAAAE,CAAA,EAJaH,EAAAG,EAAA7B,KAAO,WAAW,SAOpCO,EAUKc,EAAAS,CAAA,EATHvB,EAQMuB,EAAAC,CAAA,EAPJxB,EAAwDwB,EAAAC,CAAA,SACxDzB,EAKCwB,EAAAE,CAAA,EAJaP,EAAAO,EAAAjC,KAAO,QAAQ,SAQjCO,EAEQc,EAAAa,CAAA,kBAGV/B,EAAmBC,EAAA+B,EAAA7B,CAAA,YACnBH,EAsBOC,EAAAgC,EAAA9B,CAAA,EArBLC,EAOO6B,EAAAC,CAAA,UACP9B,EAYO6B,EAAAE,CAAA,4IA3BiDtC,EAAY,CAAA,EAAGA,EAAY,CAAA,EAAGA,QAA9BA,EAAY,CAAA,EAAGA,EAAY,CAAA,EAAGA,EAAY,CAAA,GAAA,MAAA,KAAA,SAAA,yCAlClFA,EAAY,CAAA,EAAG,cAAgB,kBAAee,GAAAC,EAAAjB,CAAA,EAM5Ce,EAAA,GAAAW,EAAA,QAAAzB,KAAO,MAAP0B,EAAAD,EAAAzB,KAAO,IAAI,EASXc,EAAA,GAAAe,EAAA,QAAA7B,KAAO,aAAP0B,EAAAG,EAAA7B,KAAO,WAAW,EAWlBc,EAAA,GAAAyB,GAAAN,EAAA,KAAA,IAAAjC,KAAO,UAAP0B,EAAAO,EAAAjC,KAAO,QAAQ,cAS9BA,EAAY,CAAA,EAAG,SAAW,WAAQe,GAAAyB,EAAAC,CAAA,aAe5BzC,EAAO,CAAA,CAAA,oBAAZ,OAAImB,GAAA,EAAA,mHAAJ,+JAvKE,MAAAuB,EAAc,GAAAC,EAAM,IAAI,MAAM,WAEhCC,EAAO,CAAA,EACPC,EAAM,CACR,KAAM,KACN,YAAa,KACb,SAAU,MAGRC,EAAe,KAGnBC,GAAO,IAAA,CACLC,eAIOA,GAAU,KACbC,EAAM,CACR,OAAQ,MACR,IAAKP,EAAW,UAChB,QAAW,CAAA,cAAe,UAAYQ,CAAU,GAGlDC,GAAMF,CAAM,EACT,cAAeG,EAAQ,KACtBR,EAAUQ,EAAS,IAAI,CAExB,CAAA,EAAA,eAAgBC,EAAK,CACpB,MAAM,yBAAyB,EAC/B,QAAQ,IAAIA,CAAK,aAIdC,GAAY,OACbC,EAAuBV,EAAO,YAChCA,EAAO,YAAY,MAAM,GAAG,EAAE,IAAIW,GAAQA,EAAK,MAAI,KAGjDC,EAAS,CACb,KAAMZ,EAAO,MAAQ,GACrB,YAAaU,EACb,SAAU,SAASV,EAAO,SAAU,EAAE,GAAK,GAG7CM,GAAM,KAAKT,EAAW,UAAWe,EAAS,CACxC,QAAO,CACL,eAAgB,mBAChB,cAAe,UAAYP,KAG5B,KAAI,UAAA,CACH,MAAM,6BAA6B,MACnCL,EAAM,CAAK,KAAM,GAAI,YAAa,GAAI,SAAU,EAAE,CAAA,EAClDG,GAED,CAAA,EAAA,eAAgBK,EAAK,CACpB,MAAM,yBAAyB,EAC/B,QAAQ,MAAM,SAAUA,CAAK,IAI1B,SAAAK,EAAaC,EAAE,CACtBR,GAAM,OAAU,GAAAT,CAAQ,WAAWiB,CAAE,GAAA,CACnC,QACE,CAAA,cAAe,UAAYT,CAAU,IAGtC,KAAI,IAAA,CACH,MAAM,6BAA6B,EACnCF,GAED,CAAA,EAAA,MAAMK,GAAK,CACV,MAAM,yBAAyB,EAC/B,QAAQ,MAAM,SAAUA,CAAK,IAI1B,SAAAO,EAAWC,EAAY,KAC9Bf,EAAee,EAAa,EAAE,MAC9BhB,EAAM,CACJ,KAAMgB,EAAa,KACnB,YAAaA,EAAa,YAAY,KAAK,IAAI,EAC/C,SAAUA,EAAa,oBAIlBC,GAAY,OACbP,EAAuBV,EAAO,YAChCA,EAAO,YAAY,MAAM,GAAG,EAAE,IAAIW,GAAQA,EAAK,MAAI,KAGjDO,EAAa,CACjB,KAAMlB,EAAO,MAAQ,GACrB,YAAaU,EACb,SAAU,SAASV,EAAO,SAAU,EAAE,GAAK,GAG7CM,GAAM,IAAG,GAAIT,CAAQ,WAAWI,CAAY,GAAIiB,EAAa,CAC3D,QAAO,CACL,eAAgB,mBAChB,cAAe,UAAYb,KAG5B,KAAI,IAAA,CACH,MAAM,6BAA6B,MACnCL,EAAM,CAAK,KAAM,GAAI,YAAa,GAAI,SAAU,EAAE,CAAA,EAClDmB,EAAA,EAAAlB,EAAe,IAAI,EACnBE,GAED,CAAA,EAAA,MAAMK,GAAK,CACV,MAAM,yBAAyB,EAC/B,QAAQ,MAAM,SAAUA,CAAK,iBAWjBR,EAAO,KAAI,KAAA,0BASXA,EAAO,YAAW,KAAA,0BAWlBA,EAAO,SAAQN,GAAA,KAAA,KAAA,oCA8BgCM,GAAAe,EAAWf,CAAM,KACpBa,EAAab,EAAO,EAAE"}