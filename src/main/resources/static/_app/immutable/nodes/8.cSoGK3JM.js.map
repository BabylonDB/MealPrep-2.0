{"version":3,"file":"8.cSoGK3JM.js","sources":["../../../../../../src/routes/user/+page.svelte"],"sourcesContent":["<script>\r\n  import axios from \"axios\";\r\n  import { onMount } from \"svelte\";\r\n  import { jwt_token } from \"../../store\"; \r\n\r\n  import { page } from \"$app/stores\";\r\n\r\n  const api_root = `${$page.url.origin}/api/user`;\r\n\r\n  let users = []; // Liste aller Benutzer\r\n  let user = {\r\n    name: \"\",\r\n    email: \"\",\r\n    password: \"\",\r\n    preferences: \"\"\r\n  }; // Benutzerobjekt für Formulareingaben\r\n  let selectedUserId = null; // Für die Edit-Funktionalität\r\n  let errorMessage = \"\"; // Fehlermeldungen\r\n  let isLoading = false; // Ladezustand\r\n\r\n  // Alle Benutzer abrufen\r\n  async function getAllUsers() {\r\n  isLoading = true;\r\n  errorMessage = \"\";\r\n  try {\r\n    const response = await axios.get(api_root, {\r\n      headers: { Authorization: \"Bearer \" + $jwt_token },\r\n    });\r\n    console.log(\"API Response:\", response.data);\r\n\r\n    if (Array.isArray(response.data)) {\r\n      users = response.data;\r\n    } else {\r\n      console.error(\"Unexpected API response format:\", response.data);\r\n      users = [];\r\n      errorMessage = \"Unexpected data format from server.\";\r\n    }\r\n  } catch (error) {\r\n    errorMessage = \"Could not fetch users.\";\r\n    console.error(\"Error fetching users:\", error.response || error.message);\r\n  } finally {\r\n    isLoading = false;\r\n  }\r\n}\r\n\r\n\r\n  // Benutzer hinzufügen oder aktualisieren\r\n  async function saveUser() {\r\n    if (!user.name || !user.email) {\r\n      errorMessage = \"Name and Email are required.\";\r\n      return;\r\n    }\r\n\r\n    try {\r\n      if (selectedUserId) {\r\n        // Benutzer aktualisieren\r\n        await axios.put(`${api_root}/${selectedUserId}`, user, {\r\n          headers: { Authorization: \"Bearer \" + $jwt_token },\r\n        });\r\n        alert(\"User updated successfully.\");\r\n      } else {\r\n        // Benutzer hinzufügen\r\n        await axios.post(api_root, user, {\r\n          headers: { Authorization: \"Bearer \" + $jwt_token },\r\n        });\r\n        alert(\"User added successfully.\");\r\n      }\r\n      resetForm();\r\n      getAllUsers();\r\n    } catch (error) {\r\n      errorMessage = \"Could not save user.\";\r\n      console.error(\"Error saving user:\", error);\r\n    }\r\n  }\r\n\r\n  // Benutzer löschen\r\n  async function deleteUser(id) {\r\n    try {\r\n      await axios.delete(`${api_root}/${id}`, {\r\n        headers: { Authorization: \"Bearer \" + $jwt_token },\r\n      });\r\n      alert(\"User deleted successfully.\");\r\n      getAllUsers();\r\n    } catch (error) {\r\n      errorMessage = \"Could not delete user.\";\r\n      console.error(\"Error deleting user:\", error);\r\n    }\r\n  }\r\n\r\n  // Benutzer zum Bearbeiten laden\r\n  function editUser(id) {\r\n  if (!id) {\r\n    console.error(\"Invalid ID provided for editUser:\", id);\r\n    return;\r\n  }\r\n  \r\n  if (!Array.isArray(users)) {\r\n    console.error(\"Users is not an array:\", users);\r\n    return;\r\n  }\r\n\r\n  const selectedUser = users.find((u) => u.id === id);\r\n  if (selectedUser) {\r\n    user = { ...selectedUser };\r\n    selectedUserId = id;\r\n  } else {\r\n    console.error(\"User not found with ID:\", id);\r\n  }\r\n}\r\n\r\n\r\n  // Formular zurücksetzen\r\n  function resetForm() {\r\n    user = { name: \"\", email: \"\", password: \"\", preferences: \"\" };\r\n    selectedUserId = null;\r\n    errorMessage = \"\";\r\n  }\r\n\r\n  // Daten beim Laden der Seite abrufen\r\n  onMount(() => {\r\n    getAllUsers();\r\n  });\r\n</script>\r\n\r\n<h1 class=\"mt-3\">User Management</h1>\r\n\r\n<!-- Fehlermeldung anzeigen -->\r\n{#if errorMessage}\r\n  <div class=\"alert alert-danger\">{errorMessage}</div>\r\n{/if}\r\n\r\n<!-- Benutzerformular -->\r\n<form class=\"mb-5\">\r\n  <div class=\"row mb-3\">\r\n    <div class=\"col\">\r\n      <label for=\"name\" class=\"form-label\">Name</label>\r\n      <input\r\n        bind:value={user.name}\r\n        type=\"text\"\r\n        id=\"name\"\r\n        class=\"form-control\"\r\n        placeholder=\"Enter user name\"\r\n      />\r\n    </div>\r\n    <div class=\"col\">\r\n      <label for=\"email\" class=\"form-label\">Email</label>\r\n      <input\r\n        bind:value={user.email}\r\n        type=\"email\"\r\n        id=\"email\"\r\n        class=\"form-control\"\r\n        placeholder=\"Enter user email\"\r\n      />\r\n    </div>\r\n  </div>\r\n  <div class=\"row mb-3\">\r\n    <div class=\"col\">\r\n      <label for=\"password\" class=\"form-label\">Password</label>\r\n      <input\r\n        bind:value={user.password}\r\n        type=\"password\"\r\n        id=\"password\"\r\n        class=\"form-control\"\r\n        placeholder=\"Enter user password\"\r\n      />\r\n    </div>\r\n    <div class=\"col\">\r\n      <label for=\"preferences\" class=\"form-label\">Preferences</label>\r\n      <input\r\n        bind:value={user.preferences}\r\n        type=\"text\"\r\n        id=\"preferences\"\r\n        class=\"form-control\"\r\n        placeholder=\"e.g., Vegetarian, Fitness\"\r\n      />\r\n    </div>\r\n  </div>\r\n  <button type=\"button\" class=\"btn btn-primary\" on:click={saveUser}>\r\n    {selectedUserId ? \"Update User\" : \"Add User\"}\r\n  </button>\r\n  {#if selectedUserId}\r\n    <button type=\"button\" class=\"btn btn-secondary ms-2\" on:click={resetForm}>\r\n      Cancel\r\n    </button>\r\n  {/if}\r\n</form>\r\n\r\n<hr />\r\n\r\n<!-- Ladezustand -->\r\n{#if isLoading}\r\n  <div class=\"spinner-border text-primary\" role=\"status\">\r\n    <span class=\"visually-hidden\">Loading...</span>\r\n  </div>\r\n{/if}\r\n\r\n<!-- Liste aller Benutzer -->\r\n<h2>All Users</h2>\r\n<table class=\"table\">\r\n  <thead>\r\n    <tr>\r\n      <th>Name</th>\r\n      <th>Email</th>\r\n      <th>Preferences</th>\r\n      <th>Actions</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    {#each users as user}\r\n      <tr>\r\n        <td>{user.name}</td>\r\n        <td>{user.email}</td>\r\n        <td>{user.preferences || \"N/A\"}</td>\r\n        <td>\r\n          <button class=\"btn btn-warning btn-sm\" on:click={() => editUser(user.id)}>\r\n            Edit\r\n          </button>\r\n          <button class=\"btn btn-danger btn-sm ms-2\" on:click={() => deleteUser(user.id)}>\r\n            Delete\r\n          </button>\r\n        </td>\r\n      </tr>\r\n    {/each}\r\n  </tbody>\r\n</table>\r\n\r\n{#if users.length === 0 && !isLoading}\r\n  <p>No users available.</p>\r\n{/if}\r\n"],"names":["ctx","insert_hydration","target","div","anchor","button","t0_value","t2_value","tr","append_hydration","td0","td1","td2","td3","button0","button1","dirty","set_data","t0","t2","t4","t4_value","p","create_if_block_3","create_if_block_2","create_if_block_1","i","if_block3","create_if_block","h1","form","div2","div0","label0","input0","set_input_value","div1","label1","input1","div5","div3","label2","input2","div4","label3","input3","hr","h2","table","thead","tbody","t15","t15_value","api_root","$page","users","user","selectedUserId","errorMessage","isLoading","getAllUsers","$$invalidate","response","axios","$jwt_token","error","saveUser","resetForm","deleteUser","id","editUser","selectedUser","u","onMount"],"mappings":"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"}