{"version":3,"file":"8.CUR45mnL.js","sources":["../../../../../../src/routes/user/+page.svelte"],"sourcesContent":["<script>\n  import axios from \"axios\";\n  import { onMount } from \"svelte\";\n  import { jwt_token } from \"../../store\"; \n\n  import { page } from \"$app/stores\";\n\n  const api_root = `${$page.url.origin}/api/user`;\n\n  let users = []; // Liste aller Benutzer\n  let user = {\n    name: \"\",\n    email: \"\",\n    password: \"\",\n    preferences: \"\"\n  }; // Benutzerobjekt für Formulareingaben\n  let selectedUserId = null; // Für die Edit-Funktionalität\n  let errorMessage = \"\"; // Fehlermeldungen\n  let isLoading = false; // Ladezustand\n\n  // Alle Benutzer abrufen\n  async function getAllUsers() {\n  isLoading = true;\n  errorMessage = \"\";\n  try {\n    const response = await axios.get(api_root, {\n      headers: { Authorization: \"Bearer \" + $jwt_token },\n    });\n    console.log(\"API Response:\", response.data);\n\n    if (Array.isArray(response.data)) {\n      users = response.data;\n    } else {\n      console.error(\"Unexpected API response format:\", response.data);\n      users = [];\n      errorMessage = \"Unexpected data format from server.\";\n    }\n  } catch (error) {\n    errorMessage = \"Could not fetch users.\";\n    console.error(\"Error fetching users:\", error.response || error.message);\n  } finally {\n    isLoading = false;\n  }\n}\n\n\n  // Benutzer hinzufügen oder aktualisieren\n  async function saveUser() {\n    if (!user.name || !user.email) {\n      errorMessage = \"Name and Email are required.\";\n      return;\n    }\n\n    try {\n      if (selectedUserId) {\n        // Benutzer aktualisieren\n        await axios.put(`${api_root}/${selectedUserId}`, user, {\n          headers: { Authorization: \"Bearer \" + $jwt_token },\n        });\n        alert(\"User updated successfully.\");\n      } else {\n        // Benutzer hinzufügen\n        await axios.post(api_root, user, {\n          headers: { Authorization: \"Bearer \" + $jwt_token },\n        });\n        alert(\"User added successfully.\");\n      }\n      resetForm();\n      getAllUsers();\n    } catch (error) {\n      errorMessage = \"Could not save user.\";\n      console.error(\"Error saving user:\", error);\n    }\n  }\n\n  // Benutzer löschen\n  async function deleteUser(id) {\n    try {\n      await axios.delete(`${api_root}/${id}`, {\n        headers: { Authorization: \"Bearer \" + $jwt_token },\n      });\n      alert(\"User deleted successfully.\");\n      getAllUsers();\n    } catch (error) {\n      errorMessage = \"Could not delete user.\";\n      console.error(\"Error deleting user:\", error);\n    }\n  }\n\n  // Benutzer zum Bearbeiten laden\n  function editUser(id) {\n  if (!id) {\n    console.error(\"Invalid ID provided for editUser:\", id);\n    return;\n  }\n  \n  if (!Array.isArray(users)) {\n    console.error(\"Users is not an array:\", users);\n    return;\n  }\n\n  const selectedUser = users.find((u) => u.id === id);\n  if (selectedUser) {\n    user = { ...selectedUser };\n    selectedUserId = id;\n  } else {\n    console.error(\"User not found with ID:\", id);\n  }\n}\n\n\n  // Formular zurücksetzen\n  function resetForm() {\n    user = { name: \"\", email: \"\", password: \"\", preferences: \"\" };\n    selectedUserId = null;\n    errorMessage = \"\";\n  }\n\n  // Daten beim Laden der Seite abrufen\n  onMount(() => {\n    getAllUsers();\n  });\n</script>\n\n<h1 class=\"mt-3\">User Management</h1>\n\n<!-- Fehlermeldung anzeigen -->\n{#if errorMessage}\n  <div class=\"alert alert-danger\">{errorMessage}</div>\n{/if}\n\n<!-- Benutzerformular -->\n<form class=\"mb-5\">\n  <div class=\"row mb-3\">\n    <div class=\"col\">\n      <label for=\"name\" class=\"form-label\">Name</label>\n      <input\n        bind:value={user.name}\n        type=\"text\"\n        id=\"name\"\n        class=\"form-control\"\n        placeholder=\"Enter user name\"\n      />\n    </div>\n    <div class=\"col\">\n      <label for=\"email\" class=\"form-label\">Email</label>\n      <input\n        bind:value={user.email}\n        type=\"email\"\n        id=\"email\"\n        class=\"form-control\"\n        placeholder=\"Enter user email\"\n      />\n    </div>\n  </div>\n  <div class=\"row mb-3\">\n    <div class=\"col\">\n      <label for=\"password\" class=\"form-label\">Password</label>\n      <input\n        bind:value={user.password}\n        type=\"password\"\n        id=\"password\"\n        class=\"form-control\"\n        placeholder=\"Enter user password\"\n      />\n    </div>\n    <div class=\"col\">\n      <label for=\"preferences\" class=\"form-label\">Preferences</label>\n      <input\n        bind:value={user.preferences}\n        type=\"text\"\n        id=\"preferences\"\n        class=\"form-control\"\n        placeholder=\"e.g., Vegetarian, Fitness\"\n      />\n    </div>\n  </div>\n  <button type=\"button\" class=\"btn btn-primary\" on:click={saveUser}>\n    {selectedUserId ? \"Update User\" : \"Add User\"}\n  </button>\n  {#if selectedUserId}\n    <button type=\"button\" class=\"btn btn-secondary ms-2\" on:click={resetForm}>\n      Cancel\n    </button>\n  {/if}\n</form>\n\n<hr />\n\n<!-- Ladezustand -->\n{#if isLoading}\n  <div class=\"spinner-border text-primary\" role=\"status\">\n    <span class=\"visually-hidden\">Loading...</span>\n  </div>\n{/if}\n\n<!-- Liste aller Benutzer -->\n<h2>All Users</h2>\n<table class=\"table\">\n  <thead>\n    <tr>\n      <th>Name</th>\n      <th>Email</th>\n      <th>Preferences</th>\n      <th>Actions</th>\n    </tr>\n  </thead>\n  <tbody>\n    {#each users as user}\n      <tr>\n        <td>{user.name}</td>\n        <td>{user.email}</td>\n        <td>{user.preferences || \"N/A\"}</td>\n        <td>\n          <button class=\"btn btn-warning btn-sm\" on:click={() => editUser(user.id)}>\n            Edit\n          </button>\n          <button class=\"btn btn-danger btn-sm ms-2\" on:click={() => deleteUser(user.id)}>\n            Delete\n          </button>\n        </td>\n      </tr>\n    {/each}\n  </tbody>\n</table>\n\n{#if users.length === 0 && !isLoading}\n  <p>No users available.</p>\n{/if}\n"],"names":["ctx","insert_hydration","target","div","anchor","button","t0_value","t2_value","tr","append_hydration","td0","td1","td2","td3","button0","button1","dirty","set_data","t0","t2","t4","t4_value","p","create_if_block_3","create_if_block_2","create_if_block_1","i","if_block3","create_if_block","h1","form","div2","div0","label0","input0","set_input_value","div1","label1","input1","div5","div3","label2","input2","div4","label3","input3","hr","h2","table","thead","tbody","t15","t15_value","api_root","$page","users","user","selectedUserId","errorMessage","isLoading","getAllUsers","$$invalidate","response","axios","$jwt_token","error","saveUser","resetForm","deleteUser","id","editUser","selectedUser","u","onMount"],"mappings":"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"}